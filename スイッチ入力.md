# スイッチ入力

スイッチが押されると、LEDが点灯して、23 番ピンでスイッチが押されたことをディスプレイに表示します。

## 配線

この状態で、スイッチを押すと、LEDが点灯します。

<img src='https://raw.githubusercontent.com/libertyfish-co/ruby-hw/images/input_switch.png' alt='スイッチ入力 配線図' width="350" />

## コーディング

`input_switch.rb` を作成します。

```ruby
require 'pi_piper'

PiPiper.watch pin: 23 do |pin|
  pin.read
  puts "#{pin.last_value} -> #{pin.value}"
end

PiPiper.wait
```

次のコマンドを実行すれば、入力待機状態になります。

```bash
rbenv sudo bundle exec ruby input_switch.rb
```

終了するには、`Ctrl + C` を押下します。

### コードの説明

* `PiPiper#watch`: `pin` を監視する。監視中に`block`を実行する。
  * [watch メソッドのソース](https://github.com/jwhitehorn/pi_piper/blob/bf17c88c8d27f87baf04868482b8082b6a8390ea/lib/pi_piper.rb#L42-L56)
* `PiPiper#read`: ピンから値を読み取り、`value`に入れる。読み取り前の`value`を`last_value`に入れる。

## やってみよう

* 23番ピンにジャンバーピンを接続して、次のコードを実行してみましょう。どうなりますか?

```ruby
require 'pi_piper'

PiPiper.watch pin: 23 do |pin|
  pin.read
  puts "#{pin.last_value} -> #{pin.value}"
end

PiPiper.wait
```

<img src='https://raw.githubusercontent.com/libertyfish-co/ruby-hw/images/unintended_input_switch.png' alt='間違った繋ぎ方' width="350" />
